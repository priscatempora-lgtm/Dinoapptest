import React, { useState, useEffect, useMemo } from 'react';
import { MapContainer, TileLayer, Marker, Popup, useMap, ZoomControl } from 'react-leaflet';
import L from 'leaflet';
import { Dinosaur, DinosaurGroup } from '../types';
import { DINOSAURS } from '../constants';
import { Search, Filter, X, MapPin, ChevronRight, Check } from 'lucide-react';

// --- Types & Interfaces ---

interface FossilMapProps {
  onSelectDino: (dino: Dinosaur) => void;
}

// --- Constants & Config ---

const MAP_CENTER: [number, number] = [20, 0];
const MAP_ZOOM = 2;

// SVG Paths for Custom Icons
const ICONS: Partial<Record<DinosaurGroup, { viewBox: string; d: string[]; transform?: string }>> = {
  Pachycephalosaurs: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: ["M10940 14695 c-8 -2 -49 -9 -90 -15 -95 -15 -152 -30 -270 -69 -125 -42 -414 -167 -465 -201 -22 -15 -71 -44 -110 -65 -70 -38 -254 -166 -310 -216 -16 -15 -55 -48 -85 -74 -111 -96 -233 -238 -448 -525 -30 -40 -316 -518 -356 -595 -143 -273 -333 -563 -456 -695 -202 -216 -270 -279 -307 -285 -58 -9 -251 -66 -313 -93 -109 -47 -203 -173 -230 -307 -16 -80 -32 -102 -82 -115 -153 -40 -347 -114 -411 -158 -62 -44 -84 -71 -113 -143 -22 -53 -28 -86 -33 -201 -7 -137 -7 -138 -50 -220 -24 -46 -55 -97 -70 -114 -55 -67 -121 -164 -153 -225 -31 -60 -33 -72 -36 -180 -4 -113 -3 -118 33 -210 34 -87 36 -99 31 -169 -15 -183 -18 -376 -7 -424 6 -28 18 -80 25 -116 21 -99 50 -165 96 -217 47 -54 87 -78 143 -88 21 -4 41 -13 44 -21 3 -8 14 -14 25 -14 19 0 88 -66 88 -84 0 -5 11 -23 23 -40 13 -17 26 -36 28 -43 7 -19 169 -193 181 -193 6 0 18 -8 27 -18 22 -25 164 -105 236 -132 84 -32 310 -41 406 -15 35 10 80 21 99 26 19 4 67 17 105 29 193 59 833 199 1075 235 201 30 231 35 273 44 48 11 273 44 427 63 139 17 623 17 705 0 113 -24 140 -31 215 -54 41 -13 76 -26 78 -30 2 -5 10 -8 18 -8 16 0 132 -60 176 -91 14 -11 31 -19 37 -19 5 0 14 -6 18 -13 4 -7 24 -24 43 -37 41 -28 54 -40 100 -100 19 -25 40 -51 47 -58 17 -18 116 -169 142 -217 12 -22 26 -47 31 -55 46 -71 317 -699 336 -777 4 -15 10 -32 15 -38 4 -5 17 -39 29 -75 22 -64 28 -78 68 -175 11 -27 26 -68 33 -90 6 -22 15 -44 19 -50 4 -5 13 -28 19 -50 7 -22 21 -58 31 -80 10 -22 30 -69 44 -105 15 -36 31 -72 37 -80 5 -8 12 -22 15 -30 4 -8 26 -56 50 -107 24 -50 44 -97 44 -103 0 -6 11 -28 25 -48 14 -20 25 -40 25 -45 0 -5 13 -27 29 -50 15 -23 47 -74 70 -113 22 -38 49 -79 59 -90 9 -11 32 -42 51 -69 19 -28 50 -66 68 -85 18 -19 33 -37 33 -41 0 -3 12 -19 26 -35 14 -16 33 -40 42 -54 19 -28 202 -220 271 -284 25 -23 128 -123 230 -224 102 -101 210 -205 239 -230 29 -26 78 -69 107 -97 30 -27 81 -75 115 -105 146 -131 332 -332 387 -418 10 -15 25 -35 34 -45 52 -57 130 -272 170 -467 16 -79 65 -210 124 -330 80 -165 210 -320 268 -320 30 0 124 36 144 56 6 6 24 16 40 21 51 20 57 23 108 53 28 17 82 46 120 65 39 20 82 43 96 53 15 9 61 40 103 67 42 28 111 72 153 99 41 27 77 56 80 63 3 7 10 13 15 13 9 0 145 95 158 110 3 4 30 26 60 49 123 96 307 271 430 411 30 34 72 81 92 103 21 23 38 46 38 50 0 4 14 21 31 38 35 35 219 276 219 288 0 4 9 19 20 32 12 12 31 39 42 59 12 19 25 37 28 40 5 4 97 154 141 228 8 15 44 83 79 152 34 69 69 137 76 152 8 14 14 32 14 39 0 7 6 20 13 28 7 9 26 48 42 86 15 39 41 98 56 133 16 35 32 75 36 90 3 15 17 50 29 79 38 85 96 268 144 453 12 47 29 105 37 129 8 25 23 90 35 145 11 56 24 120 29 143 4 23 15 97 24 165 9 68 20 139 25 158 14 54 32 224 35 335 2 55 8 145 13 200 27 269 -16 783 -89 1059 -12 44 -4 45 -155 -7 -56 -20 -119 -39 -140 -43 -22 -3 -43 -10 -49 -14 -5 -5 -37 -11 -70 -15 -33 -4 -87 -13 -120 -20 -183 -41 -445 -21 -630 48 -56 21 -207 98 -223 114 -7 7 -20 13 -28 13 -8 0 -22 8 -32 18 -9 9 -39 30 -66 46 -174 102 -476 432 -633 691 -51 85 -113 197 -113 205 0 5 -20 46 -45 91 -64 115 -148 313 -220 519 -19 52 -52 140 -75 195 -23 55 -64 168 -92 250 -134 400 -192 524 -426 910 -46 77 -109 176 -139 220 -30 44 -62 96 -73 115 l-18 36 45 69 c24 39 63 106 86 150 39 75 42 85 42 165 0 113 -23 158 -132 258 -113 104 -122 127 -121 308 1 177 -11 210 -123 310 -50 45 -156 91 -300 130 -80 21 -159 60 -219 106 -14 11 -97 90 -185 176 -88 87 -183 178 -210 202 -28 25 -92 83 -142 129 -186 169 -435 340 -639 438 -316 152 -634 224 -977 222 -95 -1 -179 -3 -187 -4z"]
  },
  Spinosaurs: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: ["M19430 14553 c-60 -10 -154 -47 -212 -85 -37 -23 -134 -112 -233 -212 -231 -235 -329 -293 -588 -352 -62 -14 -152 -39 -202 -57 -85 -30 -95 -37 -182 -123 -86 -85 -154 -179 -230 -315 -61 -108 -128 -195 -223 -289 -99 -98 -176 -155 -312 -230 -145 -81 -241 -177 -306 -306 -32 -64 -70 -177 -128 -378 -68 -239 -141 -423 -207 -525 -60 -93 -92 -128 -182 -197 -78 -60 -129 -111 -200 -199 -83 -103 -101 -160 -140 -445 -19 -136 -60 -311 -85 -360 -21 -41 -112 -130 -133 -130 -20 0 -105 -77 -131 -119 -13 -20 -29 -54 -36 -76 -7 -22 -38 -89 -69 -150 -99 -193 -220 -292 -386 -316 -79 -11 -127 -7 -233 22 -276 74 -555 359 -832 849 -20 36 -53 92 -72 125 -19 33 -95 164 -168 290 -72 127 -141 246 -152 265 -103 179 -371 517 -535 676 -84 82 -265 233 -358 301 -154 112 -457 255 -680 321 -383 114 -632 152 -997 152 -418 0 -743 -59 -1343 -245 -136 -42 -145 -42 -320 -1 -207 49 -302 33 -519 -86 -71 -39 -148 -77 -170 -83 -54 -16 -87 -4 -208 74 -115 75 -176 92 -241 67 -52 -20 -205 -155 -278 -246 -205 -255 -294 -331 -481 -411 -51 -22 -106 -46 -123 -53 -16 -8 -97 -42 -180 -75 -82 -34 -163 -68 -180 -75 -16 -8 -68 -30 -115 -49 -441 -183 -615 -261 -1005 -449 -296 -143 -375 -178 -626 -273 -147 -56 -537 -182 -624 -201 -118 -26 -385 -112 -455 -146 -112 -54 -241 -180 -287 -278 -56 -120 -78 -266 -62 -410 18 -158 62 -262 130 -307 36 -23 45 -25 107 -19 l68 7 88 -105 c108 -130 297 -299 310 -278 3 5 -1 33 -9 63 -24 91 -45 284 -45 409 l0 119 35 28 c55 46 162 101 238 125 92 28 239 21 372 -17 50 -14 144 -37 210 -51 107 -23 136 -25 265 -21 172 5 257 24 456 98 138 51 174 67 469 199 357 160 619 268 801 331 220 75 607 159 731 159 69 0 138 -26 184 -70 32 -30 39 -44 39 -75 0 -56 -51 -100 -186 -159 -187 -84 -391 -183 -487 -237 -101 -58 -365 -231 -494 -325 -151 -110 -367 -266 -438 -317 -339 -244 -626 -405 -885 -496 -190 -66 -430 -120 -537 -121 -29 0 -64 -5 -78 -12 -23 -10 -29 -8 -56 18 -38 36 -113 142 -205 291 -38 62 -72 113 -76 113 -16 0 -22 -82 -22 -305 l1 -240 -73 -48 c-96 -63 -138 -123 -130 -188 7 -62 36 -123 94 -191 129 -156 277 -218 517 -218 215 0 272 20 799 280 967 477 1487 641 2426 765 873 115 1145 180 1478 356 222 117 360 218 510 372 45 46 82 81 82 77 0 -17 -113 -154 -209 -253 -144 -148 -321 -280 -487 -365 -212 -108 -616 -225 -919 -266 -66 -10 -192 -28 -280 -41 -88 -13 -184 -26 -212 -30 -64 -8 -80 -25 -24 -25 40 0 378 -55 522 -85 41 -9 157 -38 259 -65 375 -100 627 -135 1054 -150 372 -12 399 -15 536 -45 427 -94 764 -305 1054 -660 116 -141 168 -216 293 -415 225 -358 276 -436 375 -568 147 -198 269 -341 410 -478 320 -315 593 -512 1008 -729 231 -122 411 -229 490 -293 78 -63 208 -192 264 -261 75 -92 123 -178 222 -391 224 -485 443 -743 834 -982 106 -65 376 -199 495 -246 55 -22 113 -46 128 -53 25 -11 33 -10 65 6 83 44 284 179 467 315 28 20 102 76 167 123 193 143 394 322 674 601 255 256 454 478 577 646 23 30 64 84 93 120 29 36 102 137 162 225 61 88 137 198 170 245 82 117 211 341 318 550 300 586 476 1073 623 1722 83 367 101 473 136 786 44 390 58 901 35 1212 -36 478 -59 688 -120 1060 -55 345 -62 385 -106 630 -24 135 -55 310 -68 390 -14 80 -30 168 -35 195 -111 581 -118 1276 -20 1795 35 181 112 450 150 522 8 14 3 19 -28 27 -108 28 -249 38 -333 24z"]
  },
  Sauropods: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: [
      "M6570 15428 c-47 -4 -98 -13 -114 -18 -16 -6 -40 -10 -53 -10 -21 0 -39 -7 -83 -32 -8 -4 -26 -13 -40 -18 -41 -17 -64 -30 -120 -69 -45 -31 -152 -143 -171 -178 -8 -16 -16 -30 -19 -33 -12 -10 -70 -111 -86 -147 -30 -71 -64 -186 -64 -219 0 -19 -4 -34 -10 -34 -5 0 -10 -20 -10 -44 0 -25 -4 -48 -10 -51 -5 -3 -10 -22 -10 -41 0 -19 -4 -42 -9 -52 -5 -9 -23 -46 -41 -82 -17 -36 -46 -81 -64 -100 -39 -43 -146 -128 -206 -164 -25 -15 -54 -32 -65 -39 -21 -13 -49 -34 -140 -107 -52 -42 -115 -118 -115 -141 0 -5 -5 -9 -11 -9 -6 0 -27 -35 -47 -77 l-37 -78 0 -180 0 -180 32 -66 c35 -71 90 -129 123 -129 11 0 20 -4 20 -8 0 -18 168 -180 207 -199 23 -12 50 -26 60 -31 64 -34 185 -62 264 -62 65 0 202 27 251 48 24 11 63 27 88 37 25 10 63 26 86 36 22 11 46 19 52 19 7 0 20 4 30 9 47 24 73 32 147 46 125 24 273 18 410 -14 64 -16 122 -28 240 -52 98 -20 143 -23 405 -24 229 -1 310 -5 360 -17 60 -15 151 -47 192 -69 10 -5 22 -9 28 -9 9 0 166 -94 195 -117 6 -4 28 -21 50 -37 22 -16 63 -51 90 -77 28 -26 61 -58 75 -71 20 -19 150 -171 183 -213 4 -5 19 -23 33 -40 14 -16 42 -55 61 -85 20 -30 50 -73 67 -95 17 -21 36 -47 41 -56 6 -10 41 -71 79 -135 63 -106 246 -460 246 -476 0 -3 18 -45 40 -92 22 -47 40 -89 40 -93 0 -5 9 -26 19 -48 40 -84 61 -132 82 -190 11 -33 35 -96 51 -140 16 -44 36 -98 44 -120 8 -22 19 -48 24 -57 6 -10 10 -25 10 -33 0 -8 4 -23 9 -33 15 -29 28 -65 42 -112 7 -25 16 -49 19 -55 4 -5 11 -27 14 -49 4 -21 11 -46 16 -55 9 -16 34 -90 50 -146 12 -42 31 -97 41 -117 5 -10 9 -29 9 -42 0 -13 6 -37 14 -53 16 -32 63 -185 77 -252 9 -46 26 -101 40 -136 4 -11 13 -39 19 -62 6 -23 15 -45 20 -48 6 -3 10 -17 10 -29 0 -13 12 -54 26 -92 15 -38 29 -84 31 -102 3 -18 9 -35 14 -38 5 -3 9 -15 9 -27 0 -13 6 -31 13 -42 7 -11 20 -47 27 -80 8 -33 20 -71 27 -85 7 -14 13 -30 13 -37 0 -16 57 -189 76 -230 8 -17 14 -36 14 -42 0 -14 40 -133 50 -146 4 -5 15 -37 25 -70 10 -33 21 -64 25 -70 4 -5 15 -37 26 -70 10 -33 21 -62 25 -65 3 -3 10 -20 14 -37 3 -18 11 -33 16 -33 5 0 9 -6 9 -12 0 -21 54 -183 63 -186 4 -2 7 -13 7 -24 0 -11 6 -32 14 -46 7 -15 18 -38 24 -52 6 -14 20 -46 31 -72 12 -26 21 -54 21 -62 0 -8 3 -16 8 -18 11 -5 42 -76 42 -98 0 -11 4 -20 10 -20 5 0 13 -12 17 -27 3 -16 17 -49 30 -74 13 -26 23 -52 23 -58 0 -6 5 -11 10 -11 6 0 10 -11 10 -25 0 -14 5 -25 10 -25 6 0 10 -11 10 -24 0 -14 7 -31 15 -40 8 -8 15 -20 15 -26 0 -6 11 -31 25 -56 14 -25 25 -51 25 -60 0 -8 7 -17 15 -20 8 -4 15 -14 15 -24 0 -10 7 -23 15 -30 8 -7 15 -21 15 -31 0 -11 4 -19 9 -19 5 0 22 -26 38 -57 15 -32 31 -60 34 -63 3 -3 9 -12 12 -20 4 -8 16 -28 26 -45 11 -16 20 -38 20 -47 1 -10 5 -18 10 -18 6 0 16 -11 23 -24 30 -57 153 -252 168 -266 3 -3 11 -17 19 -32 8 -16 18 -28 23 -28 4 0 8 -7 8 -15 0 -7 6 -18 13 -22 7 -4 21 -25 32 -46 11 -21 30 -50 42 -65 13 -15 26 -31 31 -37 4 -5 24 -35 45 -65 20 -30 48 -68 62 -85 26 -31 48 -59 77 -97 44 -58 115 -145 138 -169 14 -15 39 -43 55 -64 17 -20 42 -50 58 -65 15 -16 27 -30 27 -33 0 -2 19 -24 43 -49 23 -25 58 -65 79 -89 81 -97 121 -144 127 -149 16 -12 111 -149 111 -159 0 -6 4 -11 9 -11 5 0 14 -13 21 -30 7 -16 16 -30 21 -30 5 0 9 -5 9 -11 0 -6 10 -25 23 -42 31 -45 46 -69 57 -95 5 -13 21 -46 34 -75 13 -29 27 -63 31 -77 4 -14 10 -27 14 -30 9 -7 41 -105 41 -124 0 -9 4 -16 9 -16 5 0 11 -12 14 -27 3 -16 10 -46 16 -68 25 -89 40 -182 60 -375 6 -52 13 -115 16 -140 3 -25 8 -76 11 -115 7 -95 34 -258 44 -270 4 -5 11 -28 15 -50 7 -39 28 -107 48 -155 13 -30 12 -28 22 -65 4 -16 14 -41 21 -55 22 -43 54 -122 54 -135 0 -8 4 -15 8 -17 5 -1 19 -25 33 -53 44 -89 102 -189 136 -236 18 -26 33 -52 33 -58 0 -6 3 -11 8 -11 4 0 16 -17 27 -37 11 -21 40 -67 63 -103 24 -36 53 -83 64 -104 11 -21 28 -47 37 -58 10 -10 27 -36 37 -58 18 -37 22 -40 62 -40 88 0 543 55 617 75 28 7 73 16 100 20 28 4 55 10 60 15 6 4 26 10 45 13 68 9 155 28 175 37 23 11 116 37 190 53 28 6 53 17 58 23 4 7 26 15 50 19 23 4 61 16 84 26 23 11 72 25 109 33 37 8 69 18 73 24 3 5 22 13 41 17 31 6 89 29 142 56 10 5 24 9 32 9 8 0 45 16 82 35 37 19 71 35 76 35 11 0 214 95 238 110 8 6 35 19 60 30 25 11 59 28 75 37 17 9 59 32 95 52 36 19 70 39 75 44 6 4 24 16 42 25 17 9 60 35 95 56 35 21 72 44 83 50 22 12 164 107 233 156 23 16 45 30 47 30 3 0 48 33 101 72 53 40 111 84 129 98 19 14 49 37 67 52 18 15 68 56 110 90 129 104 211 180 258 237 25 30 53 61 63 70 9 8 17 21 17 27 0 7 7 14 15 18 8 3 15 10 15 16 0 6 6 17 13 25 6 7 28 36 47 64 19 28 47 66 62 84 15 17 28 37 28 42 0 6 8 18 18 26 22 21 52 58 52 65 0 8 27 34 37 34 4 0 16 18 26 40 10 22 25 40 33 40 8 0 14 6 14 14 0 8 20 35 44 60 24 25 47 54 51 66 3 11 13 20 21 20 8 0 14 7 14 15 0 9 7 18 15 21 8 4 12 10 9 15 -3 5 2 9 10 9 9 0 16 8 16 18 0 9 11 29 25 44 14 15 25 32 25 37 0 5 6 16 13 23 22 23 89 128 106 166 6 12 14 22 18 22 5 0 19 23 32 50 13 28 28 50 32 50 5 0 9 7 9 15 0 8 5 15 10 15 6 0 10 4 10 10 0 5 9 19 20 30 11 11 20 27 20 35 0 8 4 15 10 15 15 0 6 -38 -14 -62 -15 -17 -16 -24 -5 -44 6 -13 16 -21 21 -18 4 3 8 -7 8 -22 l0 -27 30 31 c16 17 32 43 36 57 3 14 10 25 15 25 5 0 9 5 9 12 0 6 6 19 14 27 8 9 26 41 42 71 15 30 34 59 41 63 7 4 13 17 13 29 0 12 11 36 25 54 14 18 25 42 25 53 0 12 7 21 15 21 10 0 15 10 15 30 0 17 4 30 10 30 7 0 74 129 121 235 5 11 13 27 18 35 11 18 51 107 62 135 4 11 17 41 28 66 12 25 21 51 21 58 0 7 7 19 15 27 8 9 15 25 15 37 0 12 7 31 15 41 8 11 15 31 15 44 0 13 7 30 15 38 8 9 15 28 15 44 0 16 4 31 9 35 5 3 17 29 26 58 10 28 21 56 26 62 5 5 9 21 9 35 0 15 11 57 24 95 19 55 22 74 14 99 -12 37 -35 95 -48 118 -14 26 -12 81 4 103 7 11 16 38 19 60 7 47 17 96 47 225 12 52 24 113 27 135 2 22 11 54 19 72 8 17 14 44 14 60 0 16 4 33 9 39 12 13 23 97 13 109 -10 15 -59 45 -72 45 -6 0 -35 11 -63 24 -29 14 -77 32 -107 42 -30 9 -59 20 -65 24 -5 4 -26 11 -45 15 -19 4 -37 11 -40 16 -3 4 -28 13 -55 19 -28 7 -63 18 -78 26 -16 8 -38 14 -50 14 -12 0 -35 7 -51 15 -15 8 -39 15 -52 15 -13 0 -32 4 -42 9 -9 6 -62 21 -117 35 -55 13 -127 32 -160 42 -33 9 -78 19 -100 21 -22 2 -49 8 -60 13 -11 4 -49 13 -85 20 -36 6 -94 18 -130 25 -36 7 -87 16 -115 19 -27 4 -72 11 -100 16 -210 39 -693 55 -955 32 -216 -19 -433 -45 -475 -56 -11 -3 -72 -15 -135 -26 -63 -12 -128 -25 -145 -30 -107 -32 -243 -67 -310 -81 -22 -4 -83 -17 -135 -29 -219 -47 -436 -67 -577 -52 -116 13 -208 29 -233 42 -9 4 -40 11 -69 15 -29 4 -65 13 -79 21 -15 8 -34 14 -42 14 -17 0 -117 39 -206 81 -34 16 -64 29 -67 29 -3 0 -29 13 -57 30 -28 17 -56 30 -61 30 -10 0 -155 96 -194 129 -11 9 -31 22 -45 29 -14 7 -50 35 -80 62 -30 27 -60 50 -67 50 -7 0 -16 7 -21 15 -4 9 -30 34 -58 56 -53 44 -205 190 -267 258 -21 22 -43 41 -48 41 -5 0 -9 5 -9 11 0 6 -32 45 -71 87 -39 42 -93 106 -120 142 -26 36 -60 79 -74 97 -28 34 -51 67 -125 178 -26 39 -54 81 -63 95 -64 93 -93 138 -103 155 -6 11 -20 36 -32 55 -12 19 -29 48 -38 65 -9 16 -23 35 -30 43 -8 7 -14 18 -14 24 0 6 -11 26 -25 44 -14 18 -25 37 -25 42 0 4 -13 26 -30 48 -16 21 -30 45 -30 52 0 8 -8 26 -19 40 -23 33 -52 84 -104 182 -21 41 -42 80 -46 85 -4 6 -14 26 -21 45 -8 19 -20 41 -27 48 -7 7 -13 22 -13 32 0 10 -7 20 -15 24 -8 3 -15 12 -15 19 0 15 -45 106 -61 122 -5 5 -9 17 -9 27 0 10 -4 18 -10 18 -5 0 -10 6 -10 13 0 6 -23 57 -50 112 -27 55 -50 104 -50 108 0 4 -16 33 -35 63 -19 30 -35 58 -35 63 0 5 -15 40 -34 77 -18 38 -37 80 -41 94 -4 14 -13 32 -20 40 -6 8 -18 31 -25 50 -8 19 -17 37 -20 40 -3 3 -18 30 -32 60 -38 81 -104 216 -140 285 -39 77 -87 172 -216 425 -57 113 -130 255 -162 315 -33 61 -69 130 -81 155 -13 25 -26 47 -29 50 -4 3 -15 23 -26 45 -22 49 -95 178 -103 185 -12 10 -68 96 -101 155 -19 33 -65 106 -102 163 -38 56 -72 110 -75 120 -4 9 -27 44 -52 77 -24 33 -57 78 -73 100 -51 71 -192 260 -199 265 -3 3 -41 48 -85 100 -43 52 -94 113 -115 135 -20 22 -60 67 -90 100 -30 33 -104 107 -164 165 -61 58 -134 129 -163 158 -29 29 -71 66 -93 82 -22 16 -72 57 -111 92 -39 35 -78 68 -87 73 -10 6 -35 23 -57 39 -57 43 -136 99 -159 113 -11 7 -58 37 -105 66 -47 29 -130 76 -185 103 -55 27 -101 52 -103 57 -2 4 -10 7 -18 7 -8 0 -38 12 -67 26 -28 15 -60 31 -69 35 -10 5 -26 9 -35 9 -10 0 -27 7 -37 15 -11 8 -30 15 -42 15 -13 0 -26 5 -29 10 -3 6 -19 10 -35 10 -16 0 -31 4 -35 9 -3 5 -31 15 -63 22 -31 7 -61 16 -67 21 -5 4 -22 8 -37 8 -15 0 -28 5 -28 10 0 6 -15 10 -34 10 -19 0 -46 4 -59 9 -14 6 -56 17 -94 25 -37 8 -102 22 -143 31 -41 9 -86 23 -100 30 -98 51 -214 105 -226 105 -8 0 -14 5 -14 10 0 6 -7 10 -16 10 -9 0 -28 6 -42 14 -57 29 -104 46 -127 46 -14 0 -25 5 -25 10 0 6 -9 10 -20 10 -10 0 -39 6 -62 14 -53 18 -234 25 -348 14z"]
  },
  Theropods: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: ["M12300 13743 c-514 -35 -847 -85 -1160 -173 -368 -104 -416 -112 -554 -86 -49 10 -171 44 -270 76 -304 99 -454 130 -622 130 -301 0 -524 -97 -929 -404 -291 -221 -434 -315 -613 -405 -269 -136 -427 -173 -952 -226 -706 -71 -974 -112 -1375 -211 -219 -54 -275 -70 -510 -149 -417 -139 -772 -308 -1082 -516 -146 -98 -180 -125 -317 -247 -332 -298 -526 -598 -672 -1040 -105 -316 -151 -562 -195 -1038 -32 -346 49 -498 311 -582 126 -41 558 -143 745 -177 518 -92 689 -109 1115 -109 449 -1 629 20 1015 119 342 88 588 193 1100 470 425 231 655 323 995 399 296 66 554 58 831 -24 96 -29 182 -61 176 -66 -2 -2 -42 5 -88 16 -193 46 -532 51 -756 10 -286 -51 -564 -175 -1030 -458 -126 -76 -291 -173 -369 -215 -633 -345 -1123 -479 -1814 -494 -500 -11 -961 40 -1530 168 -124 28 -260 61 -303 74 -68 19 -77 20 -77 6 0 -9 13 -80 29 -158 115 -556 314 -944 648 -1264 311 -297 625 -431 1113 -474 213 -19 438 -19 631 0 298 30 779 119 1404 260 519 118 739 161 954 190 525 69 927 60 1826 -41 282 -31 659 -43 827 -24 589 63 1046 280 1425 674 293 304 510 690 639 1134 28 99 74 318 75 365 1 31 1 31 9 7 14 -45 11 -343 -6 -472 -54 -417 -248 -858 -517 -1175 -202 -239 -479 -457 -758 -599 -62 -31 -70 -23 86 -79 245 -89 553 -267 784 -453 378 -306 624 -632 1071 -1422 223 -394 350 -593 553 -865 154 -206 194 -253 398 -471 164 -176 412 -401 538 -489 l42 -29 107 13 c417 50 940 170 1361 313 812 276 1515 676 2131 1213 92 80 344 331 447 445 463 512 862 1210 1058 1855 237 779 288 1657 145 2490 -32 188 -55 301 -72 357 -13 43 -14 43 -213 53 -152 8 -523 40 -680 60 -412 52 -864 150 -1180 257 -279 95 -657 270 -849 395 -411 267 -732 584 -1323 1305 -359 438 -651 732 -986 991 -245 190 -425 299 -709 429 -458 209 -914 318 -1498 358 -132 9 -470 11 -580 3z m-2400 -1077 c74 -12 74 -13 35 -20 -81 -14 -161 -38 -205 -60 l-45 -23 -6 -109 c-9 -149 -46 -239 -135 -328 -115 -114 -326 -131 -603 -51 -130 38 -231 75 -231 84 0 3 25 19 56 35 30 16 117 74 192 129 317 231 500 331 647 350 66 9 224 5 295 -7z"]
  },
  "Marine Reptiles": {
      "viewBox": "0 0 2400 1792",
      "transform": "translate(0,1792) scale(0.1,-0.1)",
      "d": ["M12845 12900 c-361 -20 -620 -49 -1085 -120 -114 -18 -209 -22 -605 -29 -529 -10 -568 -14 -795 -86 -128 -41 -254 -91 -560 -225 -384 -167 -507 -207 -985 -319 -143 -34 -316 -75 -385 -91 -69 -16 -186 -43 -260 -60 -74 -16 -211 -48 -305 -70 -487 -114 -743 -172 -1275 -286 -527 -113 -840 -165 -1195 -199 -102 -10 -394 -53 -505 -75 -394 -77 -727 -298 -870 -579 -35 -69 -50 -120 -61 -201 -12 -94 -3 -165 25 -197 l22 -25 129 31 c356 87 583 100 895 52 514 -80 608 -90 935 -98 223 -5 712 7 865 22 25 2 108 9 185 15 77 6 226 20 330 30 105 11 255 24 335 29 546 38 1016 83 1250 122 179 29 482 98 935 212 531 134 789 178 1136 197 195 10 554 5 759 -10 264 -21 246 -28 -75 -29 -439 -2 -786 -31 -1135 -97 -170 -32 -292 -63 -705 -176 -715 -197 -1026 -250 -1725 -298 -85 -6 -225 -17 -310 -25 -315 -30 -834 -72 -1110 -90 -277 -18 -913 -18 -1120 0 -80 7 -215 25 -300 39 -389 64 -416 67 -604 67 -158 0 -305 -18 -446 -56 -129 -35 -129 -36 -102 -132 13 -43 41 -116 63 -162 32 -69 56 -100 127 -171 81 -81 97 -92 227 -155 302 -146 446 -167 1115 -165 656 1 1281 -21 2115 -75 617 -41 1042 -75 1370 -111 127 -14 271 -30 320 -35 172 -17 371 -40 520 -59 139 -18 269 -33 390 -45 184 -18 573 -37 750 -36 443 1 743 55 1085 195 193 79 336 163 535 312 103 77 327 279 382 345 39 45 49 34 12 -13 -52 -68 -220 -256 -300 -338 -211 -214 -460 -378 -721 -474 -327 -120 -614 -166 -1040 -166 -318 0 -831 35 -1027 70 -30 6 -56 8 -59 5 -6 -6 23 -17 150 -56 57 -17 164 -53 238 -79 74 -26 162 -57 195 -68 33 -10 240 -80 460 -155 403 -136 603 -195 815 -241 144 -30 478 -81 630 -96 332 -31 619 -75 845 -130 472 -115 844 -291 1335 -635 251 -176 477 -323 611 -397 167 -92 488 -253 494 -247 3 3 -15 77 -40 164 -25 87 -45 164 -45 172 0 27 -73 240 -110 318 -20 44 -58 111 -83 149 -26 38 -47 71 -47 75 0 14 128 -122 182 -194 100 -133 123 -184 339 -765 165 -442 274 -620 545 -887 430 -423 1000 -720 1714 -891 264 -64 430 -85 675 -86 177 -1 219 2 270 17 114 36 167 75 208 152 20 37 21 54 19 205 -7 440 -104 886 -281 1287 -119 272 -322 496 -600 664 -47 28 -149 91 -226 139 -77 48 -175 106 -217 130 -43 24 -76 46 -73 48 9 9 350 -135 505 -214 335 -169 497 -303 656 -542 74 -112 126 -224 195 -427 l58 -170 89 -3 90 -3 30 83 c226 630 352 1184 409 1810 23 249 22 817 -1 1083 -18 205 -67 601 -91 730 -74 401 -158 772 -224 980 -11 33 -35 112 -55 176 -20 64 -42 121 -49 127 -18 14 -401 31 -857 37 -482 6 -764 18 -935 40 -22 3 -95 12 -163 20 -293 37 -568 108 -861 222 -297 116 -452 194 -786 398 -38 24 -131 77 -205 117 -74 41 -175 98 -224 126 -49 29 -90 52 -92 52 -1 0 -40 22 -86 48 -234 135 -512 245 -908 361 -323 94 -686 152 -1140 181 -273 17 -342 19 -505 10z"]
  },
  Stegosaurs: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: ["M18817 14710 c-59 -14 -162 -69 -313 -165 -27 -18 -68 -42 -90 -53 -22 -11 -68 -39 -102 -61 -33 -23 -64 -41 -68 -41 -8 0 -180 -106 -204 -126 -8 -6 -85 -55 -171 -107 -150 -91 -201 -122 -354 -220 -38 -24 -153 -96 -255 -160 -102 -64 -218 -139 -258 -167 -127 -89 -178 -185 -192 -360 -5 -58 -13 -154 -19 -215 -6 -60 -15 -182 -21 -270 -40 -613 -61 -915 -70 -1010 -5 -60 -12 -153 -15 -205 -7 -127 -16 -234 -21 -241 -2 -3 -65 -9 -141 -13 -76 -3 -187 -11 -246 -17 -60 -6 -110 -9 -112 -7 -5 4 9 68 39 183 48 187 192 785 210 875 8 36 30 137 51 224 72 309 55 348 -292 681 -104 99 -332 322 -508 496 -408 403 -467 457 -545 498 -58 31 -73 35 -145 35 -81 0 -111 -9 -177 -56 -31 -21 -214 -224 -348 -384 -47 -56 -152 -179 -235 -274 -82 -95 -174 -202 -203 -239 -74 -91 -224 -270 -243 -290 -33 -34 -177 -218 -196 -251 -31 -53 -46 -134 -39 -203 3 -33 30 -133 60 -221 29 -89 95 -289 145 -446 151 -470 312 -951 337 -1009 13 -29 24 -60 24 -67 0 -15 -52 -43 -185 -99 -49 -21 -94 -42 -99 -46 -6 -5 -17 -9 -25 -9 -8 0 -45 -16 -82 -35 -48 -25 -70 -32 -75 -23 -4 6 -11 82 -15 167 -5 86 -13 203 -19 261 -5 58 -19 258 -30 445 -12 189 -28 366 -36 399 -33 136 -75 172 -435 371 -42 23 -89 51 -105 62 -16 10 -47 29 -69 40 -73 37 -429 236 -558 312 -112 65 -185 102 -267 136 -109 46 -212 27 -294 -52 -56 -55 -69 -82 -196 -433 -15 -41 -43 -115 -62 -165 -78 -200 -278 -733 -331 -885 -76 -214 -57 -310 104 -536 46 -65 102 -146 124 -181 22 -35 79 -120 126 -191 47 -70 120 -179 162 -242 42 -63 104 -155 138 -205 116 -167 169 -246 169 -253 -1 -4 -24 -23 -53 -43 -29 -20 -94 -72 -146 -115 -103 -87 -163 -133 -172 -134 -4 0 -10 17 -13 38 -18 101 -177 746 -201 812 -40 113 -56 122 -525 286 -427 150 -540 171 -646 119 -83 -41 -109 -90 -139 -266 -24 -141 -43 -244 -84 -464 -77 -406 -81 -462 -36 -543 16 -30 90 -117 170 -200 77 -81 167 -176 200 -212 33 -36 105 -112 161 -170 56 -58 118 -124 139 -148 l38 -43 -49 -50 c-62 -63 -279 -224 -302 -224 -15 0 -18 20 -29 180 -13 195 -25 284 -47 337 -15 35 -161 184 -255 260 -202 163 -228 178 -303 178 -80 0 -106 -27 -162 -172 -25 -65 -46 -121 -46 -125 0 -5 -23 -85 -51 -178 -66 -221 -65 -257 5 -395 27 -52 64 -120 84 -150 41 -64 132 -242 132 -258 0 -6 -21 -19 -47 -29 -41 -15 -77 -18 -253 -18 -133 1 -215 5 -232 13 l-27 11 21 48 c11 26 53 107 91 178 107 197 107 197 107 267 0 96 -59 303 -121 429 -75 151 -145 134 -406 -101 -122 -109 -163 -176 -163 -264 0 -27 -4 -88 -10 -135 -5 -47 -12 -117 -16 -154 -3 -42 -11 -70 -19 -73 -19 -8 -224 91 -231 111 -8 20 16 66 104 198 36 54 71 115 78 135 19 54 17 184 -6 317 -21 127 -42 175 -81 189 -32 11 -48 2 -166 -86 -106 -80 -186 -161 -208 -214 -18 -42 -59 -194 -69 -259 -11 -62 -16 -75 -31 -75 -17 0 -145 69 -145 78 0 4 23 52 52 107 47 92 52 106 52 170 0 61 -5 83 -43 170 -43 102 -85 155 -120 155 -11 0 -39 -16 -63 -35 -24 -19 -66 -50 -94 -68 -63 -43 -117 -105 -133 -154 -7 -21 -15 -75 -18 -120 -3 -46 -11 -87 -17 -93 -8 -6 -28 -4 -58 4 -25 8 -103 20 -174 27 -104 10 -147 10 -224 -1 -52 -7 -205 -16 -340 -20 -289 -10 -360 -19 -516 -66 -122 -37 -217 -80 -369 -169 -189 -109 -212 -122 -296 -158 -47 -20 -92 -37 -100 -37 -8 0 -99 -32 -204 -71 -104 -39 -260 -95 -345 -125 -85 -30 -168 -61 -185 -68 -16 -8 -58 -25 -92 -39 -68 -28 -220 -128 -276 -182 -63 -61 -160 -226 -202 -345 -27 -76 -17 -292 13 -278 4 2 35 18 69 36 129 67 235 95 368 96 86 1 195 -18 195 -33 0 -5 -46 -25 -102 -45 -57 -21 -130 -48 -163 -61 -33 -13 -97 -31 -143 -41 -49 -10 -82 -22 -82 -30 0 -28 127 -127 225 -175 169 -82 241 -86 438 -25 162 51 184 54 413 66 313 16 390 3 626 -106 64 -30 120 -54 124 -54 3 0 69 -30 145 -66 245 -115 350 -144 662 -184 282 -36 375 -61 546 -148 129 -65 320 -203 421 -304 38 -38 254 -228 335 -294 87 -71 257 -188 350 -241 199 -112 234 -130 330 -170 212 -89 452 -168 630 -208 257 -58 420 -110 529 -167 86 -46 213 -135 279 -198 71 -66 224 -265 329 -427 165 -252 265 -381 408 -523 104 -103 109 -107 310 -230 74 -45 147 -91 162 -101 121 -84 429 -204 601 -234 309 -53 628 -42 1027 36 254 49 358 80 575 166 134 53 317 139 341 161 21 18 21 21 8 99 -21 119 -30 289 -23 401 11 161 89 371 182 492 152 197 303 319 797 647 80 52 177 119 215 148 39 29 90 66 115 81 252 162 723 605 965 909 68 85 154 210 236 342 20 32 63 99 94 148 69 109 266 489 427 825 78 163 364 735 431 862 25 46 74 134 111 197 36 62 66 115 66 116 0 23 208 326 325 474 378 480 905 852 1466 1035 103 34 188 66 189 71 3 11 -116 86 -255 160 -49 26 -113 60 -141 76 -52 29 -147 71 -266 116 -39 15 -68 32 -68 40 0 23 39 88 175 293 72 107 132 200 135 205 7 14 62 98 177 270 14 22 45 69 68 105 23 36 105 158 181 273 234 349 264 411 264 542 0 82 -14 130 -96 325 -31 74 -69 171 -86 215 -16 44 -56 145 -88 225 -32 80 -76 192 -99 250 -22 58 -60 157 -86 220 -25 63 -59 151 -76 195 -177 462 -205 525 -263 591 -97 108 -211 147 -339 114z m-14197 -6936 c0 -22 -70 -110 -98 -123 -34 -16 -42 -14 -42 12 0 27 33 68 80 101 41 29 60 32 60 10z"]
  },
  Ankylosaurs: {
    viewBox: "0 0 4800 3584",
    transform: "translate(0,3584) scale(0.1,-0.1)",
    d: [
      "M47972 35828 c6 -18 28 -21 28 -4 0 9 -7 16 -16 16 -9 0 -14 -5 -12 -12z",
      "M35440 27003 c-14 -2 -51 -13 -83 -24 -31 -10 -72 -19 -91 -19 -18 0 -50 -7 -70 -15 -21 -9 -60 -20 -87 -25 -29 -6 -58 -18 -67 -30 -9 -11 -49 -31 -88 -44 -81 -29 -275 -121 -321 -154 -17 -12 -34 -22 -38 -22 -20 0 -154 -67 -175 -88 -31 -30 -68 -55 -194 -128 -55 -32 -109 -69 -120 -81 -11 -13 -25 -23 -31 -23 -6 0 -29 -15 -51 -33 -21 -18 -52 -42 -68 -52 -16 -11 -41 -29 -56 -40 -15 -11 -66 -46 -113 -78 -48 -32 -88 -66 -92 -75 -3 -10 -18 -25 -33 -34 -34 -20 -127 -100 -237 -204 -100 -93 -100 -94 -155 -94 -54 -1 -119 -15 -133 -29 -7 -7 -4 -23 11 -53 11 -24 27 -63 35 -88 8 -25 44 -132 81 -238 36 -106 66 -206 66 -223 0 -16 6 -42 13 -57 26 -53 54 -177 77 -337 12 -87 19 -295 9 -295 -7 0 -41 106 -75 236 -14 56 -38 127 -54 158 -16 31 -36 82 -45 113 -9 32 -45 112 -80 178 -34 66 -91 174 -124 239 -34 66 -75 135 -92 153 -16 19 -29 38 -29 43 0 5 -17 29 -37 53 -21 24 -72 91 -113 148 -41 56 -101 130 -133 162 -32 33 -92 97 -134 143 -41 46 -81 84 -87 84 -6 0 -32 17 -58 38 -166 133 -265 190 -368 212 -25 6 -67 21 -95 35 -62 30 -285 67 -442 72 -217 9 -497 -62 -606 -153 -15 -13 -58 -40 -95 -61 -37 -20 -94 -56 -127 -79 -33 -22 -75 -49 -93 -58 -18 -9 -45 -30 -60 -45 -15 -15 -39 -34 -54 -42 -56 -29 -232 -198 -324 -311 -30 -38 -61 -68 -68 -68 -7 0 -27 -21 -43 -47 -17 -27 -65 -89 -105 -139 -41 -50 -95 -122 -120 -160 -93 -140 -181 -195 -388 -243 -47 -11 -116 -31 -155 -44 -38 -14 -97 -32 -130 -42 -33 -10 -116 -37 -185 -60 -69 -23 -157 -48 -195 -55 -39 -7 -101 -24 -139 -37 l-69 -24 -36 29 c-20 16 -56 58 -81 94 -118 172 -317 378 -423 438 -28 16 -68 44 -87 61 -44 41 -311 175 -365 184 -22 4 -59 14 -83 22 -65 24 -348 24 -467 0 -221 -44 -317 -81 -580 -220 -229 -121 -431 -294 -641 -548 l-105 -127 -92 -21 c-51 -11 -123 -25 -162 -31 -204 -29 -301 -54 -319 -83 -10 -16 -17 -98 -25 -317 -19 -526 -33 -629 -143 -1065 -11 -44 -28 -114 -38 -155 -39 -164 -149 -480 -208 -595 -17 -34 -46 -102 -66 -152 -20 -51 -51 -120 -70 -155 -19 -35 -43 -83 -52 -108 -26 -65 -75 -143 -85 -133 -8 8 51 203 91 303 19 47 46 130 100 310 17 58 40 134 51 168 11 35 24 98 30 140 6 42 14 83 19 92 12 22 50 201 66 315 9 55 22 143 29 195 8 52 20 226 26 385 10 249 10 317 -4 485 -17 203 -29 262 -78 368 -16 34 -29 67 -29 74 0 6 -11 25 -24 43 -13 17 -31 48 -40 68 -8 21 -36 56 -62 80 -26 23 -64 58 -83 78 -37 37 -104 75 -221 125 -61 25 -76 27 -252 32 -195 4 -377 -12 -498 -45 -30 -8 -73 -19 -95 -23 -88 -19 -156 -40 -286 -89 -75 -28 -140 -51 -146 -51 -6 0 -37 -13 -70 -29 -59 -30 -113 -52 -232 -97 -36 -13 -72 -31 -81 -39 -9 -8 -56 -30 -106 -49 -108 -41 -214 -85 -234 -97 -8 -5 -84 -44 -168 -87 -85 -42 -186 -94 -225 -114 -40 -20 -78 -37 -85 -38 -7 0 -43 -18 -80 -40 -37 -23 -78 -43 -92 -46 -14 -3 -36 -11 -50 -19 -14 -8 -56 -31 -95 -50 -38 -20 -82 -45 -96 -56 -14 -11 -47 -26 -75 -33 -34 -8 -52 -19 -59 -34 -6 -15 -26 -28 -55 -36 -50 -16 -163 -73 -225 -115 -84 -56 -120 -46 -52 15 44 39 203 162 267 207 19 13 83 57 142 98 59 41 137 92 173 114 37 22 85 54 108 70 70 51 254 168 320 203 85 45 93 55 71 76 -16 16 -44 17 -358 12 -384 -6 -557 -16 -896 -52 -370 -39 -444 -49 -458 -58 -15 -9 -161 -36 -357 -66 -71 -11 -139 -25 -150 -30 -59 -28 -200 -63 -300 -75 -33 -4 -69 -12 -80 -18 -11 -6 -56 -18 -100 -28 -125 -27 -208 -49 -219 -58 -6 -5 -65 -23 -131 -40 -66 -16 -154 -42 -195 -56 -41 -15 -95 -30 -120 -35 -42 -7 -116 -32 -405 -138 -253 -92 -305 -112 -322 -121 -50 -26 -150 -71 -158 -71 -19 0 -171 -62 -271 -111 -55 -27 -107 -49 -115 -49 -8 0 -19 -4 -24 -9 -12 -10 -177 -81 -190 -81 -5 0 -27 -9 -49 -19 -58 -28 -152 -61 -216 -77 -30 -7 -95 -25 -145 -39 -49 -14 -119 -32 -155 -40 -416 -98 -453 -110 -761 -258 -42 -21 -78 -37 -81 -37 -3 0 -43 -22 -89 -50 -46 -27 -97 -56 -114 -63 -29 -14 -164 -100 -254 -164 -25 -18 -64 -45 -85 -59 -67 -45 -266 -222 -309 -275 -23 -29 -73 -91 -112 -140 -38 -48 -91 -114 -117 -147 -25 -32 -76 -115 -113 -185 -49 -92 -75 -132 -95 -142 -15 -8 -74 -23 -131 -34 -57 -10 -149 -35 -203 -55 -56 -20 -118 -36 -142 -36 -71 0 -224 -47 -260 -81 -11 -10 -24 -19 -29 -19 -21 0 -194 -96 -225 -125 -19 -18 -55 -45 -80 -60 -25 -15 -96 -79 -158 -141 -63 -63 -120 -114 -128 -114 -7 0 -18 -10 -25 -21 -6 -12 -21 -33 -34 -48 -38 -42 -73 -97 -121 -190 -63 -121 -146 -273 -166 -304 -10 -15 -18 -31 -18 -36 0 -6 -10 -13 -22 -15 -13 -3 -52 -10 -88 -17 -36 -6 -75 -17 -86 -25 -12 -7 -45 -19 -75 -28 -93 -26 -179 -57 -179 -65 0 -4 -24 -22 -52 -41 -29 -18 -69 -43 -89 -56 -63 -40 -160 -136 -209 -209 -27 -38 -74 -101 -107 -139 -32 -38 -72 -87 -89 -110 -17 -23 -73 -81 -125 -130 -122 -115 -142 -135 -236 -236 -43 -47 -125 -136 -182 -197 -57 -61 -114 -131 -126 -155 -28 -57 -61 -107 -112 -172 -23 -30 -55 -74 -70 -99 -36 -59 -130 -216 -202 -337 -31 -52 -69 -116 -86 -142 -16 -25 -52 -83 -80 -128 -27 -45 -64 -104 -82 -131 -18 -27 -52 -87 -76 -132 -42 -79 -72 -130 -122 -207 -12 -19 -39 -64 -59 -100 -20 -36 -46 -83 -59 -105 -13 -22 -36 -69 -51 -105 -16 -36 -39 -87 -51 -115 -13 -27 -28 -75 -34 -105 -6 -30 -18 -91 -27 -135 -35 -175 -53 -257 -68 -303 -13 -43 -43 -169 -66 -282 -5 -25 -14 -90 -20 -145 -6 -55 -16 -131 -22 -170 -28 -165 -8 -758 28 -874 8 -25 14 -58 14 -75 0 -36 16 -123 43 -231 11 -44 29 -125 41 -180 13 -55 27 -109 33 -120 10 -18 26 -69 82 -255 28 -89 51 -153 61 -165 5 -6 18 -46 30 -89 11 -44 30 -90 40 -104 11 -14 20 -33 20 -43 0 -10 25 -66 55 -124 30 -59 55 -111 55 -115 0 -13 98 -175 124 -205 15 -16 45 -55 67 -85 22 -30 53 -62 69 -71 15 -10 31 -22 34 -28 4 -6 36 -20 72 -31 143 -44 324 -10 371 70 22 39 43 38 73 -2 29 -40 113 -130 160 -172 19 -17 44 -42 57 -56 13 -14 29 -31 36 -38 6 -7 58 -51 115 -99 56 -47 102 -89 102 -93 0 -5 14 -13 32 -19 18 -6 57 -28 88 -48 158 -105 188 -122 221 -127 20 -4 44 -15 54 -26 9 -10 42 -24 73 -31 31 -6 65 -17 77 -24 11 -7 54 -18 95 -25 47 -7 82 -18 95 -30 12 -11 58 -27 115 -39 188 -39 316 -62 420 -76 58 -8 134 -19 170 -25 185 -27 513 -20 675 15 33 7 85 16 115 20 47 6 105 18 345 75 22 5 75 16 117 25 43 8 92 21 110 29 89 39 253 79 392 96 49 6 101 17 115 24 14 8 51 17 81 20 61 8 176 30 262 52 32 8 73 14 91 14 19 0 58 4 88 10 146 27 495 73 722 95 84 8 199 20 257 27 72 8 275 12 655 11 544 0 765 -8 1085 -38 91 -9 237 -20 325 -25 189 -11 383 -33 486 -55 41 -8 95 -15 121 -15 26 0 58 -4 72 -10 14 -5 83 -19 153 -30 70 -12 155 -28 188 -37 119 -31 237 -59 422 -99 39 -8 77 -22 83 -29 7 -8 28 -17 49 -20 43 -7 57 -11 231 -65 237 -74 254 -79 295 -85 43 -7 72 -15 150 -41 73 -24 167 -49 230 -63 22 -5 83 -20 135 -34 52 -14 139 -35 192 -46 54 -11 110 -27 125 -34 31 -16 118 -32 262 -47 52 -6 129 -18 170 -27 93 -19 93 -19 266 -33 77 -6 156 -15 176 -20 20 -6 94 -15 165 -20 71 -6 152 -13 179 -15 28 -2 129 -9 225 -14 96 -5 204 -14 240 -20 36 -6 146 -15 245 -22 192 -11 394 -30 590 -53 66 -8 228 -20 360 -26 132 -6 269 -15 305 -20 36 -6 130 -20 210 -31 232 -33 243 -35 275 -48 44 -18 187 -48 290 -61 50 -6 126 -22 170 -35 44 -13 103 -27 130 -30 98 -13 191 -37 276 -71 48 -19 100 -34 116 -34 16 0 38 -7 49 -15 10 -8 29 -15 40 -15 12 0 53 -13 90 -29 38 -16 87 -32 109 -35 22 -4 74 -18 115 -30 41 -13 104 -31 140 -39 75 -18 390 -125 405 -137 6 -5 33 -16 60 -25 28 -10 55 -21 61 -26 6 -5 39 -24 75 -42 35 -18 87 -48 114 -65 28 -17 63 -39 79 -48 30 -16 189 -137 215 -161 7 -8 43 -33 80 -58 36 -24 86 -62 111 -85 25 -22 69 -55 99 -72 30 -17 62 -38 70 -45 56 -48 93 -67 226 -118 147 -56 184 -68 430 -138 210 -60 319 -89 370 -97 28 -5 85 -15 128 -24 43 -8 108 -18 145 -22 37 -3 78 -11 91 -16 13 -4 67 -17 120 -28 151 -32 276 -63 421 -104 47 -13 119 -33 162 -45 174 -47 347 -126 429 -195 14 -12 70 -44 124 -70 86 -43 211 -123 225 -146 3 -5 28 -20 55 -35 28 -14 80 -47 116 -73 36 -26 88 -62 115 -81 93 -65 209 -166 339 -295 106 -105 349 -315 423 -364 158 -106 194 -131 248 -176 65 -54 151 -111 241 -161 30 -16 89 -55 131 -86 42 -31 124 -81 182 -111 58 -30 164 -87 235 -126 162 -89 180 -94 237 -55 24 16 63 43 88 60 25 17 54 41 65 53 10 11 57 50 104 85 126 94 284 260 417 436 31 41 78 99 105 129 80 92 152 208 309 500 40 74 78 142 85 150 14 16 95 208 95 226 0 5 11 25 24 43 14 18 30 55 36 83 7 28 21 73 32 102 11 28 30 81 43 117 12 36 29 78 37 95 32 62 116 339 153 504 9 41 25 102 35 135 10 33 24 87 31 120 6 33 28 116 49 185 21 69 40 149 44 178 3 30 14 64 25 78 11 13 22 44 26 67 4 23 13 56 20 72 8 17 20 51 29 76 8 25 23 61 34 80 11 19 32 65 47 103 50 126 172 357 304 573 91 150 104 168 160 228 20 22 48 58 61 80 30 49 127 154 234 253 44 40 88 86 98 102 10 17 26 30 37 30 13 0 33 20 58 57 21 32 74 92 118 133 44 41 137 131 206 200 70 69 149 145 176 170 72 65 153 160 170 198 18 44 128 187 169 220 18 15 44 48 57 72 33 60 125 204 166 260 19 25 47 72 62 105 16 33 47 88 68 122 22 34 45 79 51 100 7 21 28 68 47 104 18 36 40 96 47 133 8 37 20 74 26 82 11 12 69 276 70 312 0 25 -28 23 -76 -7 -26 -17 -58 -31 -70 -31 -12 0 -27 -6 -33 -14 -14 -17 -133 -66 -160 -66 -10 0 -39 -11 -65 -25 -26 -14 -58 -25 -72 -25 -13 0 -41 -7 -62 -16 -111 -46 -399 -105 -655 -134 -91 -10 -400 -4 -516 9 -154 19 -334 60 -411 95 l-44 20 34 8 c21 4 49 2 70 -4 23 -8 124 -12 290 -12 210 0 283 4 415 22 88 13 187 32 220 42 33 11 94 27 135 35 91 19 284 83 388 128 42 19 93 37 113 41 21 4 48 15 60 25 13 10 60 33 104 50 118 48 339 169 430 237 44 33 100 74 125 91 124 86 253 252 361 467 59 117 62 127 99 336 26 147 11 441 -30 600 -5 19 -18 71 -29 115 -28 113 -54 199 -86 280 -14 39 -30 82 -35 98 -5 15 -18 46 -29 70 -64 133 -164 393 -205 532 -14 50 -42 140 -62 201 -32 99 -35 122 -37 235 -2 128 21 287 48 339 116 217 184 337 256 453 27 43 49 81 49 85 0 4 9 18 20 32 11 14 20 31 20 39 0 7 12 32 28 55 44 66 166 322 206 431 59 165 116 438 116 558 0 67 -22 253 -39 327 -15 68 -48 166 -84 250 -34 81 -149 281 -172 300 -8 7 -15 23 -15 36 0 12 -5 26 -11 30 -6 4 -24 35 -39 68 -29 63 -117 188 -184 261 -21 22 -44 54 -53 70 -8 17 -23 39 -33 50 -9 11 -41 62 -70 113 -50 90 -52 96 -47 150 6 57 33 184 60 277 8 28 20 73 27 100 6 28 20 66 30 85 9 19 23 60 30 90 7 30 23 91 35 135 13 44 30 132 39 195 9 63 21 142 27 175 5 33 11 92 12 130 2 39 8 80 15 91 8 16 11 102 9 300 l-3 279 -33 81 c-26 67 -39 87 -70 107 -21 14 -63 53 -92 87 -36 41 -74 72 -114 92 -114 58 -225 208 -225 305 0 21 -9 60 -19 88 -28 72 -81 250 -81 270 0 10 -6 41 -14 69 -46 161 -67 240 -85 318 -27 113 -120 346 -165 412 -63 90 -70 100 -108 153 -43 58 -231 219 -328 280 -36 22 -97 53 -135 68 -39 15 -92 39 -120 53 -123 61 -214 74 -535 77 -151 2 -286 1 -300 -2z"
    ]
  },
  Ornithopods: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: ["M15015 15084 c-22 -3 -112 -11 -200 -20 -307 -29 -802 -105 -1037 -159 -566 -131 -634 -150 -1068 -294 -344 -115 -694 -250 -935 -360 -33 -15 -98 -44 -145 -64 -97 -42 -627 -312 -650 -332 -8 -7 -49 -30 -90 -52 -100 -53 -304 -173 -412 -242 -48 -31 -120 -76 -159 -101 -149 -94 -235 -150 -269 -175 -19 -14 -93 -67 -165 -117 -215 -151 -538 -398 -650 -497 -16 -14 -64 -55 -105 -90 -401 -344 -758 -699 -1130 -1127 -105 -121 -380 -419 -414 -447 -39 -35 -180 -169 -355 -341 -96 -94 -184 -178 -197 -186 -12 -9 -71 -63 -131 -120 -59 -58 -140 -132 -180 -165 -171 -143 -373 -328 -411 -377 -167 -216 -244 -737 -140 -942 18 -35 22 -38 51 -32 97 20 224 17 372 -9 495 -87 549 -87 735 4 108 52 170 102 295 236 139 149 133 144 199 184 67 40 121 60 161 60 26 0 23 -3 -21 -18 -100 -34 -198 -121 -304 -271 -114 -161 -221 -258 -338 -307 -92 -38 -306 -54 -451 -33 -166 24 -402 24 -440 0 -37 -22 113 -196 249 -290 115 -78 231 -133 354 -166 79 -21 120 -25 229 -26 74 0 152 5 177 12 44 11 275 105 295 120 30 21 349 125 462 150 121 28 319 63 433 77 157 20 644 28 795 14 61 -6 142 -13 180 -16 39 -3 106 -10 150 -16 143 -18 523 -28 680 -18 344 21 488 58 816 207 74 33 222 123 258 155 47 43 6 -15 -46 -64 -188 -178 -481 -323 -794 -392 -168 -38 -244 -46 -448 -48 -101 -1 -195 -4 -209 -8 -24 -7 -21 -9 34 -31 165 -65 332 -162 506 -294 176 -134 187 -144 291 -256 166 -178 285 -353 400 -588 98 -200 142 -316 283 -747 85 -260 110 -331 187 -515 19 -47 47 -114 62 -150 118 -285 414 -793 599 -1026 23 -29 61 -78 86 -110 261 -338 535 -607 963 -948 340 -270 539 -461 632 -606 46 -72 106 -214 125 -297 7 -29 14 -53 17 -53 3 0 24 14 47 32 273 211 573 524 801 833 56 76 205 301 205 309 0 2 28 51 62 108 185 311 385 828 477 1233 69 304 117 643 146 1030 19 254 12 840 -13 1082 -10 101 -21 185 -24 188 -3 3 -46 -1 -94 -9 -129 -23 -312 -21 -410 4 -224 57 -488 248 -663 479 -144 189 -286 482 -389 801 -93 287 -130 437 -208 830 -93 472 -195 804 -339 1106 -31 65 -66 139 -78 164 -78 168 -287 440 -479 626 -107 104 -328 272 -448 342 -58 34 -164 86 -235 117 -237 102 -225 96 -272 158 -49 67 -63 109 -63 187 0 165 113 359 299 513 282 235 601 424 1091 647 436 198 631 270 950 349 240 59 468 97 697 117 176 16 225 16 370 6 303 -22 571 -78 790 -166 80 -32 165 -74 455 -223 136 -70 222 -95 345 -101 163 -7 264 20 392 108 108 73 214 223 255 359 18 62 21 192 6 272 -33 173 -175 336 -385 442 -150 75 -217 98 -525 182 -288 78 -557 127 -975 177 -136 16 -246 20 -550 23 -209 1 -398 1 -420 -1z"]
  },
  Ceratopsians: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: ["M10825 14804 c-375 -62 -670 -186 -961 -405 -103 -78 -258 -218 -334 -303 -25 -28 -65 -71 -89 -96 -47 -49 -146 -179 -231 -305 -52 -77 -207 -372 -244 -465 -81 -200 -161 -500 -200 -740 -24 -148 -24 -153 -37 -366 -9 -158 -9 -237 0 -370 27 -373 82 -677 172 -948 37 -110 38 -121 24 -142 -21 -33 -73 -44 -207 -44 -248 0 -544 62 -813 170 -130 52 -201 85 -500 230 -175 85 -246 118 -375 174 -47 21 -114 51 -150 68 -167 78 -315 135 -490 188 -58 17 -152 47 -210 66 -138 44 -308 86 -505 123 -257 48 -249 48 -272 14 -18 -24 -133 -303 -133 -320 0 -4 -8 -25 -18 -47 -10 -23 -26 -68 -35 -101 -8 -33 -29 -99 -46 -146 -16 -47 -42 -131 -56 -185 -15 -54 -31 -112 -36 -129 -7 -25 -46 -191 -118 -505 -6 -25 -15 -76 -21 -115 -6 -38 -13 -82 -15 -96 -21 -120 -43 -315 -69 -609 -19 -203 -30 -796 -16 -855 5 -22 17 -141 26 -265 27 -365 46 -513 99 -760 7 -36 21 -101 30 -145 9 -44 25 -114 36 -155 10 -41 28 -115 40 -165 24 -105 47 -183 60 -207 5 -10 9 -29 9 -42 0 -14 9 -49 19 -78 10 -29 32 -93 47 -143 16 -49 32 -91 36 -93 4 -2 12 -28 19 -58 7 -30 15 -54 20 -54 4 0 10 -12 14 -27 3 -16 13 -41 21 -58 15 -34 53 -139 61 -172 3 -13 9 -23 14 -23 5 0 9 -7 9 -15 0 -8 4 -23 8 -33 21 -42 65 -139 72 -157 19 -49 153 -328 160 -335 3 -3 23 -41 45 -85 22 -44 42 -82 45 -85 3 -3 14 -21 24 -40 11 -19 35 -62 53 -95 19 -33 50 -89 70 -125 19 -35 42 -70 49 -78 8 -7 14 -19 14 -26 0 -7 9 -21 19 -33 10 -11 27 -35 36 -53 9 -18 26 -42 36 -53 10 -12 19 -27 19 -34 0 -7 3 -13 8 -13 4 0 32 -37 62 -83 30 -45 61 -88 68 -95 6 -7 12 -16 12 -20 0 -6 16 -28 60 -79 5 -7 10 -14 10 -17 0 -7 39 -63 88 -126 24 -30 53 -68 65 -83 12 -16 32 -41 45 -55 13 -15 37 -46 54 -69 17 -24 35 -43 40 -43 4 0 8 -4 8 -9 0 -13 122 -151 228 -259 23 -24 42 -46 42 -49 0 -3 15 -20 33 -38 17 -17 113 -114 212 -216 99 -101 198 -199 220 -218 48 -40 249 -226 282 -260 21 -21 29 -23 80 -18 32 4 78 13 103 21 25 8 86 26 135 41 100 30 109 34 248 99 54 25 101 46 106 46 5 0 14 7 21 15 7 8 21 15 31 15 11 0 19 4 19 10 0 5 18 14 39 20 22 6 41 14 43 19 2 5 26 20 53 34 61 30 174 111 263 187 9 8 38 31 62 49 62 48 69 54 123 103 69 62 66 58 139 139 136 151 180 204 225 273 26 39 52 76 59 83 6 6 26 42 45 80 18 37 37 70 41 71 4 2 8 9 8 16 0 7 11 34 24 62 13 27 27 60 31 74 4 14 16 37 26 52 11 14 19 33 19 41 0 9 5 19 10 22 6 4 22 29 36 57 51 101 169 268 188 268 4 0 17 10 29 23 32 33 128 107 139 107 5 0 28 13 51 28 44 30 95 55 187 92 30 12 63 26 72 31 10 5 25 9 34 9 9 0 30 6 47 14 39 16 145 41 247 57 41 6 84 15 95 20 11 4 45 13 75 19 30 7 63 16 72 21 10 5 24 9 32 9 8 0 19 6 23 13 4 6 26 21 48 32 22 11 46 26 53 32 7 7 17 13 22 13 5 0 15 6 22 13 20 19 98 69 143 92 22 11 42 23 43 28 2 4 10 7 17 7 14 0 76 30 85 41 5 6 35 14 93 26 15 3 27 9 27 13 0 17 178 27 208 11 10 -5 47 -15 82 -21 36 -6 70 -15 75 -20 6 -4 33 -11 60 -15 28 -4 55 -11 60 -15 6 -4 39 -11 75 -15 36 -3 79 -10 95 -15 17 -5 75 -13 129 -19 54 -5 104 -15 109 -20 6 -6 28 -11 49 -11 21 0 38 -4 38 -8 0 -4 15 -9 33 -10 31 -3 71 -11 235 -50 80 -19 192 -59 202 -72 7 -9 98 -50 110 -50 5 0 10 -4 10 -8 0 -4 17 -14 38 -21 66 -22 270 -119 347 -165 23 -13 52 -27 65 -31 14 -4 58 -30 99 -56 41 -27 77 -49 82 -49 4 0 14 -6 21 -13 7 -6 27 -19 43 -27 17 -8 32 -17 35 -20 3 -3 23 -14 45 -25 22 -11 58 -32 79 -47 21 -16 45 -28 52 -28 7 0 14 -4 16 -8 6 -17 231 -120 323 -148 33 -11 62 -21 65 -24 3 -3 24 -12 48 -20 23 -7 42 -17 42 -22 0 -4 9 -8 20 -8 11 0 20 -4 20 -10 0 -5 8 -10 18 -10 9 0 34 -11 54 -25 20 -14 42 -25 47 -25 6 0 11 -4 11 -9 0 -9 73 -61 103 -73 9 -4 17 -12 17 -18 0 -5 6 -10 14 -10 8 0 21 -6 28 -13 7 -7 30 -21 51 -30 20 -10 37 -22 37 -27 0 -6 8 -10 18 -10 10 0 22 -4 27 -9 6 -4 35 -17 65 -27 30 -10 57 -21 60 -24 10 -11 179 -63 255 -78 128 -27 209 -34 292 -28 105 7 232 25 253 35 8 5 47 14 85 21 39 8 75 17 80 21 6 4 27 10 48 14 20 4 37 11 37 16 0 4 18 13 41 19 22 6 55 20 72 30 18 11 43 25 57 32 14 7 27 15 30 19 3 3 33 25 67 48 70 48 139 114 148 142 4 10 9 19 13 19 9 -1 52 -68 52 -81 0 -5 5 -9 10 -9 6 0 10 -9 10 -20 0 -11 4 -20 9 -20 5 0 15 -29 22 -65 7 -36 16 -65 21 -65 4 0 8 -18 8 -39 0 -22 5 -43 10 -46 6 -3 10 -20 10 -36 0 -30 19 -59 38 -59 17 0 117 44 152 68 80 52 190 151 228 202 22 30 49 64 59 75 33 37 83 103 83 111 0 4 6 15 14 23 12 14 35 56 126 226 34 65 84 220 119 375 5 19 11 42 14 50 9 23 29 236 31 328 4 167 -41 411 -114 617 -44 127 -80 196 -161 315 -32 47 -65 93 -71 104 -7 10 -19 24 -25 32 -7 7 -13 17 -13 22 0 5 -7 16 -16 23 -25 21 -36 59 -36 131 0 73 22 153 50 184 9 10 36 44 59 76 23 31 53 68 65 81 42 46 58 67 58 76 0 5 8 15 19 22 22 17 162 229 209 319 19 36 41 72 48 81 8 8 14 20 14 26 0 6 15 43 34 84 33 74 50 132 62 221 6 44 5 47 -19 53 -28 7 -30 7 -292 -58 -182 -46 -309 -61 -581 -70 -104 -4 -313 7 -425 23 -151 21 -449 136 -594 229 -137 89 -214 151 -323 261 -138 140 -268 325 -306 435 -49 143 -15 371 76 511 39 58 192 214 212 214 7 0 20 9 27 19 16 23 178 145 222 167 16 9 50 31 76 49 60 43 259 155 275 155 6 0 16 4 22 9 5 5 41 26 79 45 39 20 77 41 85 46 23 14 274 120 285 120 6 0 22 6 36 14 14 7 39 16 55 20 16 4 60 19 97 33 38 14 103 33 145 43 43 10 102 26 132 35 54 17 158 43 275 70 33 7 80 20 105 28 25 8 74 22 110 32 36 10 84 24 108 32 24 7 64 18 90 23 26 6 56 14 67 19 11 5 63 24 115 41 156 54 503 215 581 271 15 10 32 19 37 19 6 0 45 22 86 50 42 27 78 50 81 50 2 0 33 21 67 47 35 25 83 61 108 79 62 46 55 41 152 122 105 89 198 189 229 247 19 35 21 49 13 72 -19 54 -94 41 -364 -64 -91 -36 -232 -87 -315 -115 -144 -47 -414 -118 -453 -118 -10 0 -38 -6 -63 -14 -118 -37 -420 -73 -678 -82 -246 -9 -252 -2 -75 69 113 45 433 200 519 250 168 100 276 178 552 404 187 152 393 416 393 503 0 40 -24 70 -56 70 -20 0 -158 -64 -184 -85 -35 -29 -392 -215 -460 -240 -41 -15 -106 -39 -145 -53 -38 -14 -74 -29 -80 -33 -5 -4 -28 -11 -50 -15 -22 -4 -58 -13 -80 -21 -22 -8 -87 -28 -145 -44 -58 -17 -123 -36 -145 -44 -39 -14 -265 -60 -505 -103 -110 -20 -245 -39 -450 -62 -52 -6 -129 -18 -170 -25 -41 -8 -111 -22 -155 -30 -118 -22 -264 -52 -315 -66 -88 -23 -306 -91 -385 -119 -44 -16 -106 -36 -138 -44 -32 -9 -88 -29 -124 -46 -37 -17 -100 -45 -142 -61 -42 -17 -98 -41 -126 -54 -177 -84 -267 -125 -271 -125 -5 0 -73 -38 -353 -196 -58 -32 -122 -69 -143 -80 -21 -12 -43 -26 -50 -32 -42 -33 -256 -131 -331 -152 -85 -22 -94 -23 -193 -11 -89 10 -113 17 -164 47 -117 68 -325 304 -459 519 -24 39 -52 81 -61 95 -27 40 -209 385 -221 419 -6 17 -15 31 -19 31 -5 0 -12 9 -15 21 -4 11 -27 63 -51 114 -24 52 -44 97 -44 100 0 4 -21 54 -46 113 -26 59 -57 134 -71 167 -30 73 -143 411 -143 428 0 7 -16 62 -35 122 -38 119 -85 303 -115 456 -10 53 -28 136 -39 185 -24 108 -45 235 -66 414 -56 454 -211 647 -590 731 -123 27 -395 34 -520 13z"]
  },
  Pterosaurs: {
    viewBox: "0 0 2400 1792",
    transform: "translate(0,1792) scale(0.1,-0.1)",
    d: ["M19885 15893 c-67 -9 -173 -52 -435 -176 -326 -154 -416 -193 -700 -299 -359 -134 -550 -196 -900 -290 -392 -106 -384 -104 -1265 -278 -542 -107 -726 -152 -1095 -267 -457 -142 -939 -339 -1354 -552 -412 -212 -642 -347 -1196 -698 -103 -66 -416 -250 -465 -275 -16 -8 -84 -44 -150 -80 -307 -168 -574 -285 -1055 -465 -637 -237 -1898 -628 -2675 -827 -204 -53 -564 -142 -770 -191 -132 -32 -339 -81 -460 -111 -121 -29 -274 -65 -340 -79 -66 -14 -223 -52 -350 -84 -126 -32 -351 -87 -500 -121 -248 -57 -397 -94 -750 -185 -71 -18 -252 -65 -401 -104 -610 -158 -922 -274 -1013 -377 -22 -26 -41 -56 -41 -67 0 -20 4 -20 163 -14 89 4 308 16 487 27 495 30 1268 72 1660 90 129 7 451 25 715 41 264 16 548 34 630 39 83 5 258 16 390 25 132 8 422 26 645 40 565 35 1141 73 1295 85 374 30 776 60 797 59 35 -2 -113 -25 -342 -54 -113 -14 -232 -30 -265 -35 -74 -12 -625 -74 -835 -95 -305 -29 -1118 -93 -1470 -115 -96 -6 -269 -17 -385 -25 -115 -9 -334 -22 -485 -30 -547 -30 -636 -35 -690 -40 -30 -3 -271 -14 -535 -25 -264 -11 -568 -25 -675 -30 -107 -6 -346 -15 -530 -20 -304 -9 -452 -20 -503 -36 -30 -9 -2 -33 88 -75 153 -71 524 -143 1020 -199 931 -103 1399 -146 2220 -200 142 -10 265 -19 525 -40 63 -5 252 -16 420 -24 301 -15 379 -22 615 -52 264 -34 625 -106 910 -183 37 -10 477 -152 560 -181 33 -11 107 -36 165 -54 58 -19 119 -40 135 -46 29 -11 194 -62 375 -116 170 -50 302 -75 660 -125 370 -51 542 -95 744 -193 362 -175 700 -496 962 -914 81 -129 171 -295 305 -563 163 -328 279 -525 429 -735 152 -212 454 -528 800 -836 321 -285 436 -420 543 -634 76 -152 137 -330 183 -534 57 -256 123 -444 242 -690 110 -228 286 -500 457 -705 84 -101 341 -372 365 -385 15 -8 37 9 129 96 371 354 651 917 851 1714 199 796 458 1286 910 1724 175 168 311 278 510 410 180 119 265 168 590 339 63 33 119 64 124 68 13 12 -214 119 -459 217 -168 67 -287 108 -530 182 -16 5 -82 20 -145 35 -63 14 -142 32 -175 40 -227 53 -635 107 -905 120 -156 8 -443 32 -534 45 -318 47 -658 200 -951 429 -125 97 -372 339 -462 451 -336 418 -568 897 -677 1400 -14 63 -41 210 -61 325 -65 381 -125 621 -195 780 -85 194 -101 345 -51 477 105 270 335 573 641 842 238 209 500 379 940 612 153 80 531 264 545 264 7 0 471 223 760 365 317 156 600 304 750 390 372 215 514 303 750 468 395 276 689 569 844 842 85 149 116 257 102 361 -9 64 -33 102 -76 120 -34 14 -43 15 -100 7z"]
  },
};

// --- Subcomponents ---

// Controller to handle map view updates
const MapController: React.FC<{ center: [number, number] | null }> = ({ center }) => {
  const map = useMap();

  useEffect(() => {
    // Invalidate size to handle layout shifts
    const timer = setTimeout(() => {
      map.invalidateSize();
    }, 200);
    return () => clearTimeout(timer);
  }, [map]);

  useEffect(() => {
    if (center) {
      map.flyTo(center, 7, {
        animate: true,
        duration: 1.2
      });
    }
  }, [center, map]);

  return null;
};

// Custom Icon Generator
const createDinoIcon = (group: DinosaurGroup, isSelected: boolean) => {
  const color = isSelected ? '#E67E22' : '#2D5A27';
  const strokeColor = '#FFFFFF';
  const size = isSelected ? 60 : 40;
  
  let svgInner = '';
  const iconData = ICONS[group];

  if (iconData) {
    const { viewBox, d, transform } = iconData;
    // Construct SVG paths
    const paths = d.map(pathData => `<path d="${pathData}" />`).join('');
    
    svgInner = `
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="${viewBox}" style="width:100%; height:100%; filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.3));">
        <g transform="${transform || ''}" fill="${color}" stroke="${strokeColor}" stroke-width="20">
          ${paths}
        </g>
      </svg>
    `;
  } else {
    // Fallback Icon
    svgInner = `
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" stroke="${strokeColor}" stroke-width="2" style="width:100%; height:100%; filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.3));">
        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
        <circle cx="12" cy="10" r="3" fill="white" />
      </svg>
    `;
  }

  return L.divIcon({
    className: 'bg-transparent border-none',
    html: `<div style="width: ${size}px; height: ${size}px; transition: transform 0.3s ease;">${svgInner}</div>`,
    iconSize: [size, size],
    iconAnchor: [size / 2, size], // Bottom center anchor mostly
    popupAnchor: [0, -size],
  });
};

// --- Main Component ---

export default function FossilMap({ onSelectDino }: FossilMapProps) {
  const [searchTerm, setSearchTerm] = useState('');
  const [activeFilter, setActiveFilter] = useState<{
    diet: string;
    era: string;
    group: string;
  }>({ diet: 'All', era: 'All', group: 'All' });
  
  const [selectedDinoId, setSelectedDinoId] = useState<string | null>(null);
  const [isFilterMenuOpen, setIsFilterMenuOpen] = useState(false);
  const [lastAction, setLastAction] = useState<'search' | 'filter' | null>(null);

  // Derived State: Filtered Dinosaurs
  const filteredDinos = useMemo(() => {
    return DINOSAURS.filter(dino => {
      // Logic for showOnMap: defaulting to true if undefined
      if (dino.showOnMap === false) return false;

      const matchesSearch = dino.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                            dino.location.name.toLowerCase().includes(searchTerm.toLowerCase());
      const matchesDiet = activeFilter.diet === 'All' || dino.diet === activeFilter.diet;
      const matchesEra = activeFilter.era === 'All' || dino.period.includes(activeFilter.era);
      const matchesGroup = activeFilter.group === 'All' || dino.group === activeFilter.group;

      return matchesSearch && matchesDiet && matchesEra && matchesGroup;
    });
  }, [searchTerm, activeFilter]);

  const selectedDino = useMemo(() => 
    DINOSAURS.find(d => d.id === selectedDinoId) || null, 
  [selectedDinoId]);

  // Memoize the center coordinate to prevent map jitter during parent re-renders (e.g. clock updates)
  const mapCenter = useMemo<[number, number] | null>(() => {
    if (selectedDino) {
      return [selectedDino.location.lat, selectedDino.location.lng];
    }
    return null;
  }, [selectedDino]);

  // Priority Logic Effect
  useEffect(() => {
    const hasActiveFilters = activeFilter.diet !== 'All' || activeFilter.era !== 'All' || activeFilter.group !== 'All';
    const hasSearch = searchTerm.trim() !== '';
    
    if (filteredDinos.length === 0) {
      // If we just searched and got no results due to filters, clear filters
      if (lastAction === 'search' && hasActiveFilters) {
        setActiveFilter({ diet: 'All', era: 'All', group: 'All' });
        setLastAction(null); // Reset action to prevent loops
      }
      // If we just filtered and got no results due to search, clear search
      else if (lastAction === 'filter' && hasSearch) {
        setSearchTerm('');
        setLastAction(null); // Reset action
      }
    }
  }, [filteredDinos.length, lastAction, activeFilter, searchTerm]);

  // Handlers
  const handleMarkerClick = (id: string) => {
    setSelectedDinoId(id);
    setIsFilterMenuOpen(false); // Close filter menu on selection
  };

  const clearFilters = () => {
    setSearchTerm('');
    setActiveFilter({ diet: 'All', era: 'All', group: 'All' });
    setSelectedDinoId(null);
    setLastAction(null);
  };

  return (
    <div className="flex flex-col h-full w-full relative bg-gray-50 overflow-hidden items-center">
      
      {/* --- Top Bar: Search & Filters --- */}
      <div className="absolute top-4 left-4 right-4 z-[1000] flex flex-col gap-2 pointer-events-none items-center">
        <div className="flex items-center gap-2 pointer-events-auto max-w-2xl w-full">
          {/* Search Input */}
          <div className="flex-1 relative shadow-lg">
            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <Search className="h-4 w-4 text-gray-400" />
            </div>
            <input
              type="text"
              className="block w-full pl-10 pr-3 py-3 border-none rounded-xl text-sm bg-white focus:ring-2 focus:ring-dino-green outline-none transition-shadow"
              placeholder="Search fossils..."
              value={searchTerm}
              onChange={(e) => {
                setSearchTerm(e.target.value);
                setLastAction('search');
              }}
            />
          </div>

          {/* Toggle Filter Menu Button */}
          <button
            onClick={() => setIsFilterMenuOpen(!isFilterMenuOpen)}
            className={`p-3 rounded-xl shadow-lg transition-colors ${isFilterMenuOpen ? 'bg-dino-green text-white' : 'bg-white text-gray-600 hover:bg-gray-100'}`}
          >
            <Filter size={20} />
          </button>
        </div>

        {/* Active Filters Chips */}
        <div className="flex flex-wrap gap-2 pointer-events-auto justify-center w-full max-w-2xl">
            {activeFilter.diet !== 'All' && (
                <div className="bg-white/90 backdrop-blur-sm border border-dino-green/20 text-dino-green text-[10px] font-bold px-2 py-1 rounded-full flex items-center gap-1 shadow-sm">
                    {activeFilter.diet}
                    <button onClick={() => {
                        setActiveFilter(prev => ({...prev, diet: 'All'}));
                        setLastAction('filter');
                    }}><X size={12} /></button>
                </div>
            )}
            {activeFilter.era !== 'All' && (
                <div className="bg-white/90 backdrop-blur-sm border border-dino-green/20 text-dino-green text-[10px] font-bold px-2 py-1 rounded-full flex items-center gap-1 shadow-sm">
                    {activeFilter.era}
                    <button onClick={() => {
                        setActiveFilter(prev => ({...prev, era: 'All'}));
                        setLastAction('filter');
                    }}><X size={12} /></button>
                </div>
            )}
            {activeFilter.group !== 'All' && (
                <div className="bg-white/90 backdrop-blur-sm border border-dino-green/20 text-dino-green text-[10px] font-bold px-2 py-1 rounded-full flex items-center gap-1 shadow-sm">
                    {activeFilter.group}
                    <button onClick={() => {
                        setActiveFilter(prev => ({...prev, group: 'All'}));
                        setLastAction('filter');
                    }}><X size={12} /></button>
                </div>
            )}
        </div>

        {/* Filter Panel (Collapsible) */}
        {isFilterMenuOpen && (
          <div className="w-full max-w-2xl flex justify-end pointer-events-none">
            <div className="pointer-events-auto bg-white/95 backdrop-blur-md rounded-2xl shadow-xl p-4 w-56 animate-in slide-in-from-top-2 fade-in duration-200 border border-gray-100">
              <div className="flex justify-between items-center mb-3">
                <h3 className="text-xs font-bold uppercase tracking-wider text-gray-500">Filters</h3>
                <button onClick={clearFilters} className="text-xs text-dino-orange hover:underline font-medium">Reset All</button>
              </div>
              
              <div className="flex flex-col gap-4">
                {/* Diet Filter */}
                <div className="space-y-1">
                  <label className="text-[10px] font-semibold text-gray-400">Diet</label>
                  <select 
                    className="w-full p-2 text-xs bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-dino-green"
                    value={activeFilter.diet}
                    onChange={(e) => {
                        setActiveFilter(prev => ({...prev, diet: e.target.value}));
                        setLastAction('filter');
                    }}
                  >
                    {['All', 'Carnivore', 'Herbivore', 'Omnivore'].map(opt => (
                      <option key={opt} value={opt}>{opt}</option>
                    ))}
                  </select>
                </div>

                {/* Era Filter */}
                <div className="space-y-1">
                  <label className="text-[10px] font-semibold text-gray-400">Period</label>
                  <select 
                    className="w-full p-2 text-xs bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-dino-green"
                    value={activeFilter.era}
                    onChange={(e) => {
                        setActiveFilter(prev => ({...prev, era: e.target.value}));
                        setLastAction('filter');
                    }}
                  >
                    {['All', 'Triassic', 'Jurassic', 'Cretaceous'].map(opt => (
                      <option key={opt} value={opt}>{opt}</option>
                    ))}
                  </select>
                </div>

                {/* Group Filter */}
                <div className="space-y-1">
                  <label className="text-[10px] font-semibold text-gray-400">Group</label>
                  <select 
                    className="w-full p-2 text-xs bg-gray-50 rounded-lg border border-gray-200 outline-none focus:border-dino-green"
                    value={activeFilter.group}
                    onChange={(e) => {
                        setActiveFilter(prev => ({...prev, group: e.target.value}));
                        setLastAction('filter');
                    }}
                  >
                    <option value="All">All Groups</option>
                    {['Theropods', 'Sauropods', 'Stegosaurs', 'Ankylosaurs', 'Ornithopods', 'Ceratopsians', 'Pachycephalosaurs', 'Spinosaurs', 'Marine Reptiles', 'Pterosaurs'].map(opt => (
                      <option key={opt} value={opt}>{opt}</option>
                    ))}
                  </select>
                </div>
              </div>
            </div>
          </div>
        )}
      </div>

      {/* --- Map Container --- */}
      <div className="flex-1 flex items-center justify-center p-1 pt-18 pb-24 md:p-8 w-full">
        <div className="w-full max-w-[700px] aspect-square rounded-[2rem] overflow-hidden shadow-2xl border-4 border-white relative z-0 group">
          <MapContainer
            center={MAP_CENTER}
            zoom={MAP_ZOOM}
            scrollWheelZoom={true}
            style={{ height: "100%", width: "100%" }}
            zoomControl={false}
            attributionControl={false}
            minZoom={2}
            maxBounds={[[-90, -180], [90, 180]]}
          >
            <TileLayer
              url="https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png"
            />
            
            <ZoomControl position="bottomright" />
            
            <MapController center={mapCenter} />

            {/* Markers */}
            {filteredDinos.map((dino) => (
              <Marker
                key={dino.id}
                position={[dino.location.lat, dino.location.lng]}
                icon={createDinoIcon(dino.group, selectedDinoId === dino.id)}
                eventHandlers={{
                  click: () => handleMarkerClick(dino.id),
                }}
              >
                {/* Optional: We could put a Popup here, but we are using a custom overlay instead */}
              </Marker>
            ))}
          </MapContainer>

          {/* Selected Dino Card Overlay (Top Position) */}
          {selectedDino && (
            <div className="absolute top-4 left-4 right-16 z-[500] bg-white/95 backdrop-blur-md p-3 rounded-xl shadow-lg border border-dino-green/20 animate-in slide-in-from-top-2 duration-300">
                <button 
                    onClick={(e) => { e.stopPropagation(); setSelectedDinoId(null); }}
                    className="absolute top-2 right-2 text-gray-400 hover:text-red-500 transition-colors"
                >
                    <X size={14} />
                </button>
                <div className="flex items-start gap-3 pr-4">
                    <div className="w-12 h-12 rounded-lg overflow-hidden flex-shrink-0 bg-gray-100 shadow-inner">
                        <img src={selectedDino.image_url} alt={selectedDino.name} className="w-full h-full object-cover" />
                    </div>
                    <div className="flex-1 min-w-0">
                        <h3 className="font-heading text-sm text-dino-dark leading-tight truncate">{selectedDino.name}</h3>
                        <div className="flex items-center text-[10px] text-gray-500 mt-0.5 truncate">
                            <MapPin size={10} className="mr-0.5 text-dino-orange" />
                            {selectedDino.location.name}
                        </div>
                        <button 
                            onClick={() => onSelectDino(selectedDino)}
                            className="mt-2 text-[10px] font-bold text-dino-green hover:underline flex items-center"
                        >
                            View Species Info &rarr;
                        </button>
                    </div>
                </div>
            </div>
          )}
        </div>
      </div>

      {/* --- Bottom Overlay: Selected Info / List --- */}
      <div className="absolute bottom-0 left-0 right-0 z-[1000] p-4 pointer-events-none">
        {/* Horizontal List of Filtered Dinos (Always show if there are filtered results) */}
        {filteredDinos.length > 0 && (
          <div className="pointer-events-auto overflow-x-auto pb-2 -mx-4 px-4 scrollbar-hide flex gap-2 snap-x snap-mandatory justify-start">
            {filteredDinos.map(dino => (
              <button
                key={dino.id}
                onClick={() => {
                  setSelectedDinoId(dino.id);
                  setIsFilterMenuOpen(false);
                }}
                className={`snap-center flex-shrink-0 bg-white p-1.5 rounded-xl shadow-lg border w-28 flex flex-col items-center gap-1.5 hover:scale-105 transition-transform ${
                    selectedDinoId === dino.id ? 'border-dino-orange ring-2 ring-dino-orange/20 scale-105' : 'border-gray-100'
                }`}
              >
                <div className="w-full h-16 rounded-lg overflow-hidden bg-gray-100">
                  <img src={dino.image_url} alt={dino.name} className="w-full h-full object-cover" loading="lazy" />
                </div>
                <div className="text-center w-full">
                  <p className="font-heading text-[10px] truncate text-dino-dark leading-tight">{dino.name}</p>
                  <p className="text-[9px] text-gray-500 truncate">{dino.location.name}</p>
                </div>
              </button>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}
